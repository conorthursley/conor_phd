%% Nonlinear Amplitude
clear all
m=0.03;
k2 =2.9609e+03;
m1 =0.3676;
k1 =1.7064e+04;
t=linspace(0,100,10000);
w=2*pi*10;
U=1*sin(w*t);


u1 = (sqrt(4*(12*k1*k2 - 6*k2*m*3028*w^2)^3 + 11664*k2^4*m*3028^2*U.^2*w^4)+ 108*k2^2*m*3028*U*w^2).^(1/3)/(6*2^(1/3)*k2)...
    - (12*k1*k2 - 6*k2*m*3028*w^2)./(3*2^(2/3)*k2*(sqrt(4*(12*k1*k2- 6*k2*m*3028*w^2)^3 + 11664*k2^4*m*3028^2*U.^2*w^4)...
    + 108*k2^2*m*3028*U*w^2).^(1/3)) + U;

u2 = -((1 - 1i*sqrt(3))*(sqrt(4*(12*k1*k2 - 6*k2*m*3028*w^2)^3 + 11664*k2^4*m*3028^2*U.^2*w^4)...
    + 108*k2^2*m*3028*U*w^2).^(1/3))/(12*2^(1/3)*k2) + ((1 + 1i*sqrt(3))*(12*k1*k2 - ...
    6*k2*m*3028*w^2))./(6*2^(2/3)*k2*(sqrt(4*(12*k1*k2 - 6*k2*m*3028*w^2)^3 + 11664*k2^4*m*3028^2*U.^2*w^4) ...
    + 108*k2^2*m*3028*U*w^2).^(1/3)) + U;

u3 = -((1 + 1i*sqrt(3))*(sqrt(4*(12*k1*k2 - 6*k2*m*3028*w^2)^3 + 11664*k2^4*m*3028^2*U.^2*w^4)...
    + 108*k2^2*m*3028*U*w^2).^(1/3))/(12*2^(1/3)*k2) + ((1 - 1i*sqrt(3))*(12*k1*k2 - ...
    6*k2*m*3028*w^2))./(6*2^(2/3)*k2*(sqrt(4*(12*k1*k2 - 6*k2*m*3028*w^2)^3 + 11664*k2^4*m*3028^2*U.^2*w^4) ...
    + 108*k2^2*m*3028*U*w^2).^(1/3)) + U;

figure
plot(t,abs(U),t,abs(u1),t,abs(u2),t,abs(u3))